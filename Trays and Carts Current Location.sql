-- Searches for trays and carts current location. Trays that are not linked to a cart will show NULL for the cart values. 
select t.UnitID TrayUnitID, sn.Value TraySN, tl.ID LineID, tl.Location Factory, tl.Description TrayLocation, ts.ID StationID, ts.Description Station, t.LastUpdate,
c.SerialNumber CartSN, cl.ID LineID, cl.Location Factory, cl.Description CartLocation, cs.ID StationID, cs.Description Station, c.LastUpdate
  from udtTray t
  join ffSerialNumber sn with(nolock) on t.UnitID = sn.UnitID and sn.SerialNumberTypeID = 0
  left outer join ffUnit u with(nolock) on sn.UnitID = u.ID
  left outer join ffStation ts with(nolock) on u.StationID = ts.ID
  left outer join ffLine tl with(nolock) on ts.LineID = tl.ID  
  left outer join udtCart c with(nolock) on t.CartID = c.ID
  left outer join ffStation cs with(nolock) on c.StationID = cs.ID
  left outer join ffLine cl with(nolock) on cs.LineID = cl.ID
 where sn.value in ('E0213586-J21',
'E0229727-M21',
'E0225657-M21',
'E0229332-M21',
'E0220676-L21',
'E0229243-M21',
'E0230079-M21',
'E0216992-J21',
'E0213397-J21',
'E0230080-M21',
'E0216194-J21',
'E0229145-M21',
'E0211785-H21',
'E0230095-M21',
'E0214655-J21',
'E0222793-M21',
'E0228867-M21',
'E0229708-M21',
'E0225807-M21',
'E0222865-M21',
'E0218307-J21',
'E0227480-M21',
'E0228277-M21',
'E0228948-M21',
'E0226017-M21',
'E0230418-M21',
'E0230420-M21',
'E0230401-M21',
'E0230411-M21',
'E0230408-M21',
'E0222945-M21',
'E0208895-H21',
'E0222712-M21',
'E0226854-M21',
'E0229330-M21',
'E0222820-M21',
'E0210572-H21',
'E0213072-J21',
'E0208589-H21',
'E0214046-J21',
'E0229350-M21',
'E0216459-J21',
'E0200206-G21',
'E0227456-M21',
'E0200290-G21',
'E0226281-M21',
'E0212915-J21',
'E0226448-M21',
'E0227005-M21',
'E0227652-M21',
'E0210163-H21',
'E0210827-H21',
'E0205173-H21',
'E0226690-M21',
'E0222431-M21',
'E0215943-J21',
'E0222868-M21',
'E0208878-H21',
'E0222683-M21',
'E0218167-J21',
'E0227101-M21',
'E0214860-J21',
'E0227674-M21',
'E0226469-M21',
'E0229735-M21',
'E0224736-M21',
'E0228684-M21',
'E0215439-J21',
'E0214439-J21',
'E0228142-M21',
'E0216388-J21',
'E0210845-H21',
'E0204903-H21',
'E0209763-H21',
'E0227045-M21',
'E0205991-H21',
'E0200138-G21',
'E0215145-J21',
'E0225436-M21',
'E0207301-H21',
'E0216651-J21',
'E0207137-H21',
'E0222642-M21',
'E0212966-J21',
'E0218113-J21',
'E0211577-H21',
'E0205120-H21',
'E0073191-K19',
'E0229374-M21',
'E0222324-M21',
'E0203746-H21',
'E0217153-J21',
'E0226320-M21',
'E0218190-J21',
'E0216378-J21',
'E0230350-M21',
'E0212098-H21',
'E0228556-M21',
'E0231271-M21',
'E0222814-M21',
'E0228810-M21',
'E0218242-J21',
'E0209936-H21',
'E0216169-J21',
'E0227688-M21',
'E0220610-L21',
'E0230564-M21',
'E0230070-M21',
'E0230557-M21',
'E0230533-M21',
'E0230556-M21',
'E0230356-M21',
'E0230531-M21',
'E0214983-J21',
'E0226495-M21',
'E0214755-J21',
'E0203633-H21',
'E0073186-K19',
'E0204532-H21',
'E0087807-K19',
'E0230185-M21',
'E0226252-M21',
'E0214472-J21',
'E0209048-H21',
'E0230082-M21',
'E0230561-M21',
'E0204289-H21',
'E0213633-J21',
'E0230529-M21',
'E0230357-M21',
'E0229318-M21'
) 
group by t.UnitID, sn.Value, tl.ID, tl.Location, tl.Description, ts.ID, ts.Description, t.LastUpdate,
c.SerialNumber, cl.ID, cl.Location, cl.Description, cs.ID, cs.Description, c.LastUpdate
order by t.LastUpdate desc